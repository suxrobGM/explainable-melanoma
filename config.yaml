# Dataset Configuration
data:
  dataset_name: "ISIC2019"
  data_dir: "./data/isic_2019"
  train_split: 0.7
  val_split: 0.15
  test_split: 0.15
  num_classes: 9  # Multi-class: All ISIC 2019 diagnostic categories
  class_names: ["MEL", "NV", "BCC", "AK", "BKL", "DF", "VASC", "SCC", "UNK"]
  # MEL: Melanoma, NV: Nevus, BCC: Basal cell carcinoma, AK: Actinic keratosis
  # BKL: Benign keratosis, DF: Dermatofibroma, VASC: Vascular, SCC: Squamous cell carcinoma, UNK: Unknown
  image_size: 384  # Input image size (384x384 for EfficientNetV2-M, 512x512 for EfficientNetV2-L)
  num_workers: 12  # Increase for faster data loading to keep GPU fed

# Model Configuration
model:
  backbone: "efficientnet_v2_m"  # Options: efficientnet_v2_s, efficientnet_v2_m, efficientnet_v2_l
  pretrained: true
  dropout_rate: 0.3

# Training Configuration
training:
  batch_size: 32  # Increase to maximize GPU memory usage
  epochs: 50
  learning_rate: 0.0001
  weight_decay: 0.0001
  optimizer: "adam"
  scheduler: "cosine"  # cosine annealing
  checkpoint_save_interval: 5  # Save checkpoint every N epochs (0 to disable)

  # Class imbalance handling
  use_class_weights: true
  focal_loss: false  # If true, use focal loss instead of weighted CE
  focal_alpha: 0.25
  focal_gamma: 2.0

  # Data augmentation
  augmentation:
    horizontal_flip: 0.5
    vertical_flip: 0.5
    rotation_degrees: 20
    color_jitter:
      brightness: 0.2
      contrast: 0.2
      saturation: 0.2
      hue: 0.1
    random_affine: true

# Evaluation Configuration
evaluation:
  metrics: ["accuracy", "sensitivity", "specificity", "auc", "f1"]
  save_confusion_matrix: true

# GradCAM Configuration
gradcam:
  target_layer: "auto"  # Auto-detected based on backbone architecture
  use_gradcam_pp: true  # Use GradCAM++ instead of GradCAM

# ABCDE Criterion Analysis Configuration
abcde:
  # Enable ABCDE analysis during inference
  enable: true

  # A - Asymmetry threshold (0-1, higher = more asymmetric)
  asymmetry_threshold: 0.3

  # B - Border irregularity threshold (0-1, higher = more irregular)
  border_threshold: 0.4

  # C - Color variation (number of distinct colors indicating concern)
  color_threshold: 3

  # D - Diameter threshold in pixels (approximate, depends on image resolution)
  # For 512x512 images, ~114px â‰ˆ 6mm if lesion fills ~50% of image
  diameter_threshold_px: 114

  # Enable ABCDE-GradCAM alignment analysis
  enable_alignment_analysis: true

# Paths
paths:
  checkpoint_dir: "./checkpoints"
  log_dir: "./logs"
  output_dir: "./outputs"
  attention_maps_dir: "./outputs/attention_maps"

# Miscellaneous
seed: 25
device: "cuda"  # or "cpu"
mixed_precision: true  # Use automatic mixed precision training
